"use strict";(self.webpackChunketebase_docs=self.webpackChunketebase_docs||[]).push([[154],{3905:function(e,t,i){i.d(t,{Zo:function(){return c},kt:function(){return u}});var n=i(7294);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||(a[i]=e[i]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var p=n.createContext({}),l=function(e){var t=n.useContext(p),i=t;return e&&(i="function"==typeof e?e(t):o(o({},t),e)),i},c=function(e){var t=l(e.components);return n.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var i=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),h=l(i),u=a,m=h["".concat(p,".").concat(u)]||h[u]||d[u]||r;return i?n.createElement(m,o(o({ref:t},c),{},{components:i})):n.createElement(m,o({ref:t},c))}));function u(e,t){var i=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=i.length,o=new Array(r);o[0]=h;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<r;l++)o[l]=i[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,i)}h.displayName="MDXCreateElement"},5786:function(e,t,i){i.r(t),i.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return u},frontMatter:function(){return s},metadata:function(){return l},toc:function(){return d}});var n=i(7462),a=i(3366),r=(i(7294),i(3905)),o=["components"],s={title:"Introduction"},p=void 0,l={unversionedId:"protocol-specs/introduction",id:"protocol-specs/introduction",title:"Introduction",description:"This document is meant as an overview for people interested in how the Etebase works behind the scenes and is not required reading for normal usage.",source:"@site/docs/protocol-specs/introduction.md",sourceDirName:"protocol-specs",slug:"/protocol-specs/introduction",permalink:"/protocol-specs/introduction",editUrl:"https://github.com/etesync/etebase-docs/edit/master/docs/protocol-specs/introduction.md",tags:[],version:"current",frontMatter:{title:"Introduction"},sidebar:"someSidebar",previous:{title:"Notes (Markdown)",permalink:"/type-specs/notes"},next:{title:"Authentication",permalink:"/protocol-specs/authentication"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Cryptographic Primitives",id:"cryptographic-primitives",level:2},{value:"Key derivation",id:"key-derivation",level:3},{value:"Hashing and MAC",id:"hashing-and-mac",level:3},{value:"Symmetric Encryption",id:"symmetric-encryption",level:3},{value:"Asymmetric Encryption",id:"asymmetric-encryption",level:3},{value:"Deterministic Encryption",id:"deterministic-encryption",level:3},{value:"Zero-Knowledge Proof",id:"zero-knowledge-proof",level:3},{value:"Additional Technologies",id:"additional-technologies",level:2},{value:"Why MsgPack",id:"why-msgpack",level:3},{value:"Why Base64 URL",id:"why-base64-url",level:3}],h={toc:d};function u(e){var t=e.components,i=(0,a.Z)(e,o);return(0,r.kt)("wrapper",(0,n.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This document is meant as an overview for people interested in how the Etebase works behind the scenes and is not required reading for normal usage."))),(0,r.kt)("p",null,"This document assumes you already read ",(0,r.kt)("a",{parentName:"p",href:"/overview"},"the overview section of the docs")," and are familiar with the main Etebase concepts."),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"The Etebase protocol is purposefully very simple. Etebase uses existing, well-tested and industry standard encryption algorithms, and use them in the most standard way possible to avoid introducing any weaknesses in otherwise secure crypto systems."),(0,r.kt)("p",null,"The client connects to the server using ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Transport_Layer_Security"},"TLS")," and then interacts with the server using a very simple ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Representational_state_transfer"},"REST API"),". We provide an ",(0,r.kt)("a",{parentName:"p",href:"https://www.openapis.org/"},"OpenAPI")," interface description and an API explorer which can be accessed from ",(0,r.kt)("a",{parentName:"p",href:"https://api.etebase.com/docs"},"the server API docs"),"."),(0,r.kt)("p",null,"This makes Etebase very easy to audit, get right and implement: thus making it a solid foundation."),(0,r.kt)("h2",{id:"cryptographic-primitives"},"Cryptographic Primitives"),(0,r.kt)("p",null,"Etebase uses the popular ",(0,r.kt)("a",{parentName:"p",href:"https://libsodium.org"},"libsodium")," for all of its cryptographic operations. More specifically it uses the following primitives:"),(0,r.kt)("h3",{id:"key-derivation"},(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Key_stretching"},"Key derivation")),(0,r.kt)("p",null,"Etebase uses ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Argon2"},"Argon2id")," for deriving secure encryption keys from user passwords. Argon2id is the current best practice is considered an improvement over the previously recommended ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Scrypt"},"Scrypt"),"."),(0,r.kt)("p",null,"It is an order of magnitudes better than alternatives such as ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/PBKDF2"},"PBKDF2")," which should not be used for such purpose."),(0,r.kt)("p",null,"Used in the rest of this document as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Deriving from a password: ",(0,r.kt)("inlineCode",{parentName:"li"},"pwhash(password: str, salt: [u8]): [u8]"),"."),(0,r.kt)("li",{parentName:"ul"},"Deriving from a key: ",(0,r.kt)("inlineCode",{parentName:"li"},"kdf(key: [u8], salt: [u8]): [u8]"))),(0,r.kt)("h3",{id:"hashing-and-mac"},(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Cryptographic_hash_function"},"Hashing")," and ",(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Key_stretching"},"MAC")),(0,r.kt)("p",null,"Hashing is and MACs are a common primitive for any cryptographic library. Etebase uses the fast and hard-to-misuse ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/BLAKE_(hash_function)#BLAKE2"},"BLAKE2b"),"."),(0,r.kt)("p",null,"Used in the rest of this document as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"MAC: ",(0,r.kt)("inlineCode",{parentName:"li"},"mac(key: [u8], content: [u8]): [u8]")),(0,r.kt)("li",{parentName:"ul"},"Hash: ",(0,r.kt)("inlineCode",{parentName:"li"},"hash(content: [u8]): [u8]"))),(0,r.kt)("h3",{id:"symmetric-encryption"},(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Symmetric-key_algorithm"},"Symmetric Encryption")),(0,r.kt)("p",null,"Etebase uses ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Salsa20#XChaCha"},"XChaCha20Poly1305")," for symmetrically encrypting data which is defined in ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/draft-arciszewski-xchacha-00"},"this IETF document"),". It's a popular ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Authenticated_encryption#Authenticated_encryption_with_associated_data_(AEAD)"},"AEAD")," construction that is fast, secure, and hard to misuse."),(0,r.kt)("p",null,"Used in the rest of this document as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Encrypt: ",(0,r.kt)("inlineCode",{parentName:"li"},"encrypt(key: [u8], content: [u8], ad?: [u8]): [u8]")),(0,r.kt)("li",{parentName:"ul"},"Decrypt: ",(0,r.kt)("inlineCode",{parentName:"li"},"decrypt(key: [u8], content: [u8], ad?: [u8]): [u8]"))),(0,r.kt)("p",null,"Where the ",(0,r.kt)("inlineCode",{parentName:"p"},"ad")," parameter is optional additional data to verify."),(0,r.kt)("h3",{id:"asymmetric-encryption"},(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Public-key_cryptography"},"Asymmetric Encryption")),(0,r.kt)("p",null,"Etebase uses the ",(0,r.kt)("a",{parentName:"p",href:"https://libsodium.gitbook.io/doc/public-key_cryptography/authenticated_encryption"},"libsodium ",(0,r.kt)("inlineCode",{parentName:"a"},"box")," functions")," which in turn uses ",(0,r.kt)("inlineCode",{parentName:"p"},"X25519")," for key exchange, ",(0,r.kt)("inlineCode",{parentName:"p"},"XSalsa20")," for encryption, and ",(0,r.kt)("inlineCode",{parentName:"p"},"Poly1305")," for authentication."),(0,r.kt)("p",null,"For digital signatures, Etebase uses the ",(0,r.kt)("a",{parentName:"p",href:"https://libsodium.gitbook.io/doc/public-key_cryptography/public-key_signatures"},"libsodium ",(0,r.kt)("inlineCode",{parentName:"a"},"sign")," functions")," which in turn use ",(0,r.kt)("inlineCode",{parentName:"p"},"Ed25519"),"."),(0,r.kt)("p",null,"Used in the rest of this document as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Sign: ",(0,r.kt)("inlineCode",{parentName:"li"},"sign(keypair: [u8], content: [u8]): [u8]"))),(0,r.kt)("h3",{id:"deterministic-encryption"},(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Deterministic_encryption"},"Deterministic Encryption")),(0,r.kt)("p",null,"Etebase uses deterministic encryption for efficient manipulation of collection types.\nFor the implementation Etebase uses the same algorithms as with ",(0,r.kt)("a",{parentName:"p",href:"#symmetric-encryption"},"symmetric encryption"),", with the main difference that the ",(0,r.kt)("inlineCode",{parentName:"p"},"nonce")," is generated using a keyed hash of the content (using a specifically derived key). This makes it so each clear text is encrypted to the same ciphertext without sacrificing security."),(0,r.kt)("p",null,"Used in the rest of this document as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Encrypt: ",(0,r.kt)("inlineCode",{parentName:"li"},"detEncrypt(key: [u8], content: [u8]): [u8]")),(0,r.kt)("li",{parentName:"ul"},"Decrypt: ",(0,r.kt)("inlineCode",{parentName:"li"},"detDecrypt(key: [u8], content: [u8]): [u8]"))),(0,r.kt)("h3",{id:"zero-knowledge-proof"},(0,r.kt)("a",{parentName:"h3",href:"https://en.wikipedia.org/wiki/Zero-knowledge_proof"},"Zero-Knowledge Proof")),(0,r.kt)("p",null,"Etebase uses a mechanism based on digital signatures for zero-knowledge proof in the authentication."),(0,r.kt)("h2",{id:"additional-technologies"},"Additional Technologies"),(0,r.kt)("p",null,"As mentioned above the Etebase protocol uses HTTP (with TLS) and a REST API for transport. It also uses the ",(0,r.kt)("a",{parentName:"p",href:"https://msgpack.org/"},"MessagePack (MsgPack)")," serialization format for all data serializations, both within the library and when communicating with the server. Additionally, when needed to serialize binary data to strings, Etebase uses ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Base64#URL_applications"},"non-padded Base64 URL"),"."),(0,r.kt)("h3",{id:"why-msgpack"},"Why MsgPack"),(0,r.kt)("p",null,"MsgPack comes with a few major advantages over other popular serialization formats (such as JSON). First of all, Etebase deals with a lot of binary data (encryptions, MACs and etc), and since MsgPack is a binary format, it means that it incurs almost no overhead when using it. Additionally, it can extract binary data without any extra allocations and copies, which is a major advantage."),(0,r.kt)("p",null,"Additionally, MsgPack is much more compact which means Etebase can store and transfer much less data. Finally, it's both widely used, and strongly typed, which makes development easier and with higher assurances."),(0,r.kt)("h3",{id:"why-base64-url"},"Why Base64 URL"),(0,r.kt)("p",null,"Base64 is the most popular binary-to-string serialization format. However it comes with a major flaw - it's not \"URL safe\". This means that it includes characters that can't be used in filenames or URL paths. Luckily, there is a variant that replaces the offending characters with URL safe equivalents, which is what we use."))}u.isMDXComponent=!0}}]);