"use strict";(self.webpackChunketebase_docs=self.webpackChunketebase_docs||[]).push([[155],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return f}});var o=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var a=o.createContext({}),s=function(e){var t=o.useContext(a),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return o.createElement(a.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,a=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=s(n),f=i,m=d["".concat(a,".").concat(f)]||d[f]||u[f]||r;return n?o.createElement(m,l(l({ref:t},p),{},{components:n})):o.createElement(m,l({ref:t},p))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=d;var c={};for(var a in t)hasOwnProperty.call(t,a)&&(c[a]=t[a]);c.originalType=e,c.mdxType="string"==typeof e?e:i,l[1]=c;for(var s=2;s<r;s++)l[s]=n[s];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5353:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return a},default:function(){return f},frontMatter:function(){return c},metadata:function(){return s},toc:function(){return u}});var o=n(7462),i=n(3366),r=(n(7294),n(3905)),l=["components"],c={title:"Collections"},a=void 0,s={unversionedId:"protocol-specs/collections",id:"protocol-specs/collections",title:"Collections",description:"As explained in the overview, collections are a collection of items. Collection objects are internally just items with additional data that is specific to each member (user) of a collection. Items and collection memberships will be covered in the next chapters. This chapter will focus on how they interact, and collection specific properties.",source:"@site/docs/protocol-specs/collections.md",sourceDirName:"protocol-specs",slug:"/protocol-specs/collections",permalink:"/protocol-specs/collections",editUrl:"https://github.com/etesync/etebase-docs/edit/master/docs/protocol-specs/collections.md",tags:[],version:"current",frontMatter:{title:"Collections"},sidebar:"someSidebar",previous:{title:"Fetching Data",permalink:"/protocol-specs/fetching-data"},next:{title:"Items",permalink:"/protocol-specs/items"}},p={},u=[{value:"Collection Type",id:"collection-type",level:2},{value:"Fetching collections",id:"fetching-collections",level:2},{value:"Collection structure",id:"collection-structure",level:2}],d={toc:u};function f(e){var t=e.components,n=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"As explained in ",(0,r.kt)("a",{parentName:"p",href:"../overview"},"the overview"),", collections are a collection of items. Collection objects are internally just items with additional data that is specific to each member (user) of a collection. Items and collection memberships will be covered in the next chapters. This chapter will focus on how they interact, and collection specific properties."),(0,r.kt)("h2",{id:"collection-type"},"Collection Type"),(0,r.kt)("p",null,"Collections have immutable types associated with them. The types define the data that's stored inside of a collection, for example ",(0,r.kt)("inlineCode",{parentName:"p"},"notes")," will mean the collection includes notes, and ",(0,r.kt)("inlineCode",{parentName:"p"},"files")," will mean the collection includes generic files. Different Etebase applications can use different collection types on the same account. Some applications even use different collection types within the same application."),(0,r.kt)("p",null,"In order to enable applications to fetch collections efficiently without revealing the collection type itself to the server, Etebase uses deterministic encryption. As explained in ",(0,r.kt)("a",{parentName:"p",href:"./introduction"},"the introduction"),", deterministic encryption means that every clear-text is always encrypted to the same cipher text."),(0,r.kt)("p",null,"Thanks to this property, Etebase clients can generate a unique collection type token for each collection type. This token can then be sent to the server in order to limit the collections returned by the query. The token is created as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"colTypeToken = detEncrypt(key, collectionType)\n")),(0,r.kt)("h2",{id:"fetching-collections"},"Fetching collections"),(0,r.kt)("p",null,"Fetching collections is done using a ",(0,r.kt)("inlineCode",{parentName:"p"},"POST")," request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"collection/list_multi/")," endpoint. The request includes a list of ",(0,r.kt)("a",{parentName:"p",href:"#collection-type"},"collection type tokens")," used to filter the results like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"Body {\n  collectionTypes: [[u8]], // each array item is a type token\n}\n")),(0,r.kt)("p",null,"You can additionally pass the following ",(0,r.kt)("a",{parentName:"p",href:"./fetching-data#fetch-options"},"fetch options"),": ",(0,r.kt)("inlineCode",{parentName:"p"},"limit"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"stoken")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"prefetch"),"."),(0,r.kt)("p",null,"The endpoint returns ",(0,r.kt)("a",{parentName:"p",href:"./fetching-data#list-responses"},"an ",(0,r.kt)("inlineCode",{parentName:"a"},"stoken")," list response")," with type ",(0,r.kt)("inlineCode",{parentName:"p"},"Collection")," and one additional field:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"removedMemberships: Option<RemovedCollection>"),": the list of collections the user lost access to but haven't been deleted.")),(0,r.kt)("h2",{id:"collection-structure"},"Collection structure"),(0,r.kt)("p",null,"TBD"))}f.isMDXComponent=!0}}]);